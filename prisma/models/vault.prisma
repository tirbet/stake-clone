enum VaultType {
    DEPOSIT
    WITHDRAWAL
    BONUS
    CASHBACK
}

model Vault {
    id                     String    @id @default(uuid())
    userId                 String
    walletId               Int
    balance                Decimal   @default(0) @db.Decimal(15, 2)
    isLocked               Boolean   @default(false)
    lockedUntil            DateTime?
    type                   VaultType
    securityPin            String? // hashed PIN
    withdrawalRestrictions Json?
    createdAt              DateTime  @default(now())
    updatedAt              DateTime  @updatedAt

    // Relations
    user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
    wallet Wallet @relation(fields: [walletId], references: [id], onDelete: Cascade)

    @@index([userId, type])
    @@index([isLocked, lockedUntil])
    @@map("vault")
}
